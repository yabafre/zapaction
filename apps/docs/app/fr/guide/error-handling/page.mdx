# Gestion d'erreurs

ZapAction garde une sémantique de propagation d'erreurs — les erreurs sont lancées, jamais encapsulées.

## Où les erreurs peuvent survenir

| Étape | Ce qui lance |
|-------|-------------|
| Parsing de l'input | Erreur de validation Zod |
| `beforeAction` | Votre logique de garde (ex: vérification auth) |
| `handler` | Votre logique métier |
| `afterAction` | Logique de post-traitement |
| Parsing de l'output | Erreur de validation Zod |

Toutes les erreurs se propagent naturellement — attrapez-les dans votre code client.

## Pattern try/catch

```tsx
const mutation = useActionMutation(createTodo);

async function handleSubmit() {
  try {
    await mutation.mutateAsync({ title: "Acheter du lait" });
  } catch (error) {
    console.error("L'action a échoué:", error);
  }
}
```

## ActionErrorBoundary

Enveloppez un arbre de composants pour attraper toute erreur :

```tsx
import { ActionErrorBoundary } from "@zapaction/react";

<ActionErrorBoundary
  fallback={({ error, reset }) => (
    <div>
      <p>Quelque chose s'est mal passé : {String(error)}</p>
      <button onClick={reset}>Réessayer</button>
    </div>
  )}
  onError={(error) => reportToSentry(error)}
>
  <TodoList />
</ActionErrorBoundary>
```

### Avec `useActionErrorReset`

Pour des composants fallback plus complexes :

```tsx
import { ActionErrorBoundary, useActionErrorReset } from "@zapaction/react";

function ErrorFallback() {
  const { error, reset } = useActionErrorReset();

  return (
    <div>
      <h2>Quelque chose s'est mal passé</h2>
      <pre>{String(error)}</pre>
      <button onClick={reset}>Réessayer</button>
    </div>
  );
}

<ActionErrorBoundary fallback={<ErrorFallback />}>
  <TodoList />
</ActionErrorBoundary>
```

## Exemple de l'app réelle

Dans l'[app d'exemple](/fr/examples/full-crud), le composant `TodoPanel` enveloppe son contenu dans un error boundary :

```tsx
export function TodoPanel() {
  return (
    <ActionErrorBoundary fallback={<ErrorFallback />}>
      <TodoPanelContent />
    </ActionErrorBoundary>
  );
}
```

Voir la [Référence ActionErrorBoundary](/fr/api-reference/action-error-boundary) pour les détails.
