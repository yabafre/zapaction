---
title: "Testing Patterns"
description: "Patterns Vitest pour actions, hooks et invalidation cache."
---

# Testing Patterns

## Statut CI en direct

[![CI](https://github.com/yabafre/zapaction/actions/workflows/ci.yml/badge.svg)](https://github.com/yabafre/zapaction/actions/workflows/ci.yml)

## Lancer les tests localement

```bash terminal
pnpm test
```

Dernier run local dans ce repository:

```txt terminal output
@zapaction/core:  Test Files 5 passed, Tests 35 passed
@zapaction/react: Test Files 2 passed, Tests 14 passed
@zapaction/query: Test Files 3 passed, Tests 6 passed
Total tests passed: 55
```

## Test de contrat d'action

```ts features/todos/actions.test.ts
import { beforeEach, describe, expect, it, vi } from "vitest";
import { __resetActionContextForTests, setActionContext } from "@zapaction/core";
import { createTodo } from "./actions";

vi.mock("next/cache", () => ({ revalidateTag: vi.fn() }));

describe("createTodo", () => {
  beforeEach(() => {
    __resetActionContextForTests();
    setActionContext(async () => ({ userId: "test-user" }));
  });

  it("cree un todo valide", async () => {
    const result = await createTodo({ title: "Ecrire des tests" });
    expect(result.title).toContain("Ecrire des tests");
  });
});
```
